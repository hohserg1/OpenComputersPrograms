local sqrt = math.sqrt
local component = require('component')
local bit_array = require('bit_array')
local computer = require('computer')
local geolyzer = component.geolyzer

if computer.getArchitecture()=="Lua 5.2" then
    print("Requied Lua 5.3")
    os.sleep(3)
    computer.setArchitecture("Lua 5.3")
end

--forms variables
local forms, Scan,Form1, Frame1, Button1, netcardsList, portEdit, widthEdit, heightEdit, yOffsetEdit
local Label1,Label12,Label13,Label14,Label15,Label3,Label4,Label5,Label6,Label7,Label8,Label9


--local startMemory=computer.freeMemory()
   

local hardness, size, elevation, height = 3, 7, -32, 64
local card
local port

local function saveConfig()
    local h = io.open("oresense.cfg","w")
    h:write(
        "return {\n"..
        "   hardness = "..    tostring(hardness)  ..", \n"..
        "   size = "..        tostring(size)      ..", \n"..
        "   elevation = "..   tostring(elevation) ..", \n"..
        "   height = "..      tostring(height)    ..", \n"..
        "\n"..
        "   network_card = \""..card                .."\", \n"..
        "   port = "..        tostring(port)      .." \n"..
        "}"        
    )
    h:close()
end

do
    local h = io.open("oresense.cfg")
    if h then
        local config = load(h:read("*a"))()
        h:close()
        hardness, size, elevation, height, card, port = 
            config.hardness, config.size, config.elevation, config.height, config.network_card, config.port
    else
        card = component.list("tunnel")() or component.list("modem")() or error("network card not found")
        port = component.type(card)=="tunnel" and 0 or component.type(card)=="modem" and 111
        saveConfig()
    end
end

--print(hardness, size, elevation, height, card, port)

local send
local function initSend()
    local c = component.proxy(card)
    if c.type=="tunnel" then
        send = function(...)
            c.send(...)
        end
    elseif c.type=="modem" then
        send = function(...)
            c.broadcast(port,...)
        end
    else
        error("unsupported network card "..c.type)
    end
end

initSend()

local sqrtCache = {
[2048]=45.254833995939,[2049]=45.265881191025,[2]=1.4142135623731,[2051]=45.287967496897,[2052]=45.299006611624,[5]=2.2360679774998,[2054]=45.321076774499,[2056]=45.343136195019,[2057]=45.354161881794,[2058]=45.365184888855,[11]=3.3166247903554,[2060]=45.387222871641,[2061]=45.398237851265,[14]=3.7416573867739,[2064]=45.431266766402,[2065]=45.442271070007,[2066]=45.453272709454,[19]=4.3588989435407,[2068]=45.475268003608,[2069]=45.486261662177,[2070]=45.497252664309,[24]=4.8989794855664,[2073]=45.530209751329,[26]=5.0990195135928,[27]=5.1961524227066,[2077]=45.574115460423,[2078]=45.585085280166,[32]=5.6568542494924,[2081]=45.617978911828,[2082]=45.628938186199,[2083]=45.639894828976,[2084]=45.650848842053,[2085]=45.661800227323,[2086]=45.672748986677,[40]=6.3245553203368,[2089]=45.705579528106,[2090]=45.71651780265,[2091]=45.727453460695,[44]=6.6332495807108,[2093]=45.749316934791,[46]=6.7823299831253,[48]=6.9282032302755,[2097]=45.793012567421,[50]=7.0710678118655,[2099]=45.814844755821,[2100]=45.825756949558,[2101]=45.836666545463,[2102]=45.847573545391,[56]=7.4833147735479,[2105]=45.880278987818,[2106]=45.891175622335,[59]=7.6811457478686,[2109]=45.92385001282,[62]=7.8740078740118,[2112]=45.956501172304,[2113]=45.967379738245,[2114]=45.978255730291,[2115]=45.989129150268,[68]=8.2462112512353,[2117]=46.010868281309,[2118]=46.021733996015,[2120]=46.043457732885,[2121]=46.054315758678,[74]=8.6023252670426,[2123]=46.076024134033,[2124]=46.086874487212,[2125]=46.097722286464,[2126]=46.108567533594,[80]=8.9442719099992,[2129]=46.141087980237,[82]=9.0553851381374,[2131]=46.162755550335,[2132]=46.173585522461,[2133]=46.184412955022,[2134]=46.195237849804,[2136]=46.216880033165,[89]=9.4339811320566,[2138]=46.238512086788,[91]=9.5393920141695,[2141]=46.270941205037,[2142]=46.281745861625,[2144]=46.303347611161,[2145]=46.314144707638,[2146]=46.324939287602,[2147]=46.335731352812,[2148]=46.346520905026,[2149]=46.357307945997,[2150]=46.368092477479,[2152]=46.389654018973,[2153]=46.400431032481,[2154]=46.411205543489,[107]=10.344080432789,[108]=10.392304845413,[109]=10.440306508911,[2158]=46.454278597348,[2161]=46.486557196678,[2162]=46.497311750251,[2163]=46.508063816934,[116]=10.770329614269,[117]=10.816653826392,[2166]=46.54030511288,[2168]=46.561786907291,[2169]=46.57252408878,[122]=11.045361017187,[123]=11.090536506409,[125]=11.180339887499,[2174]=46.626172907499,[2176]=46.647615158762,[129]=11.357816691601,[2178]=46.669047558312,[131]=11.44552314226,[2180]=46.690470119715,[2181]=46.701177715342,[2182]=46.711882856507,[2184]=46.733285782192,[2185]=46.743983570081,[2186]=46.754678910244,[2187]=46.76537180436,[140]=11.832159566199,[2189]=46.786750261158,[142]=11.916375287813,[2192]=46.818799642879,[2193]=46.829477895872,[2194]=46.840153714521,[2195]=46.85082710049,[148]=12.165525060596,[149]=12.206555615734,[150]=12.247448713916,[2200]=46.904157598234,[2201]=46.91481642296,[2202]=46.9254728266,[155]=12.449899597989,[2205]=46.957427527496,[158]=12.569805089977,[2208]=46.989360497883,[161]=12.68857754045,[2210]=47.010637094173,[2211]=47.021271782035,[164]=12.806248474866,[2213]=47.042533945356,[166]=12.884098726725,[168]=12.961481396816,[2217]=47.085029467974,[170]=13.038404810405,[2219]=47.106262853256,[172]=13.114877048604,[173]=13.152946437966,[2222]=47.138094997571,[176]=13.266499161422,[2225]=47.169905660283,[2226]=47.180504448342,[179]=13.37908816026,[180]=13.416407864999,[2229]=47.212286536452,[182]=13.490737563232,[184]=13.564659966251,[185]=13.601470508735,[186]=13.638181696986,[187]=13.674794331177,[2237]=47.296934361542,[190]=13.78404875209,[192]=13.856406460551,[2241]=47.339201514178,[2242]=47.349762407007,[2243]=47.360320944858,[2244]=47.370877129308,[197]=14.035668847618,[2246]=47.391982444291,[2248]=47.413078364519,[2249]=47.423622805518,[2250]=47.434164902526,[203]=14.247806848775,[2252]=47.455242070819,[205]=14.317821063276,[2254]=47.476309881877,[208]=14.422205101856,[209]=14.456832294801,[2258]=47.518417482067,[211]=14.525839046334,[2260]=47.539457296019,[2261]=47.549973711875,[2262]=47.560487802376,[216]=14.696938456699,[2265]=47.592016137163,[2266]=47.602520941648,[219]=14.798648586949,[221]=14.866068747319,[2270]=47.644516998286,[224]=14.966629547096,[2273]=47.675989764241,[2274]=47.686476070265,[227]=15.066519173319,[2276]=47.707441767506,[229]=15.132745950422,[230]=15.165750888103,[232]=15.231546211728,[233]=15.264337522474,[2282]=47.770283649985,[2283]=47.780749261601,[2284]=47.791212581394,[2285]=47.801673610868,[2286]=47.812132351528,[241]=15.52417469626,[242]=15.556349186104,[243]=15.58845726812,[2292]=47.874836814343,[245]=15.652475842499,[246]=15.684387141358,[248]=15.748015748024,[2297]=47.927027865287,[250]=15.811388300842,[2299]=47.947888378947,[2301]=47.968739820846,[2302]=47.979162143581,[2304]=48.0,[2305]=48.010415536631,[2306]=48.020828814172,[2307]=48.031239834091,[260]=16.124515496597,[2309]=48.052055106936,[262]=16.186414056239,[264]=16.248076809272,[2313]=48.093658625644,[266]=16.3095064303,[2315]=48.114446894878,[268]=16.370705543745,[2317]=48.135226186235,[270]=16.431676725155,[272]=16.492422502471,[2321]=48.176757881784,[2322]=48.187135212627,[275]=16.583123951777,[2324]=48.207883172776,[2325]=48.218253804965,[278]=16.673332000533,[280]=16.733200530682,[2329]=48.259714048055,[282]=16.792855623747,[2331]=48.280430818293,[285]=16.881943016134,[286]=16.911534525288,[288]=16.970562748477,[2337]=48.342527861087,[290]=17.029386365926,[291]=17.058722109232,[292]=17.088007490635,[293]=17.117242768624,[294]=17.146428199482,[296]=17.204650534085,[2345]=48.425200051213,[2346]=48.435524153249,[299]=17.291616465791,[300]=17.320508075689,[2349]=48.466483264211,[302]=17.378147196983,[2352]=48.497422611929,[305]=17.464249196573,[2354]=48.518037882833,[307]=17.521415467935,[308]=17.549928774784,[309]=17.578395831247,[2358]=48.559242168716,[2360]=48.579831205964,[313]=17.691806012954,[314]=17.720045146669,[2363]=48.610698410947,[2365]=48.631265663151,[2366]=48.641546028061,[320]=17.888543819998,[321]=17.916472867169,[2370]=48.682645778552,[323]=17.972200755611,[2372]=48.703182647544,[325]=18.02775637732,[326]=18.055470085268,[2376]=48.744230427816,[329]=18.138357147217,[2378]=48.764741360946,[331]=18.19340539866,[332]=18.220867158289,[333]=18.248287590895,[334]=18.275666882497,[2384]=48.826222462935,[2385]=48.836461788299,[338]=18.38477631085,[339]=18.411952639522,[340]=18.439088914586,[341]=18.466185312619,[2390]=48.887626246321,[344]=18.547236990991,[345]=18.574175621007,[2394]=48.9285192909,[347]=18.627936010197,[349]=18.681541692269,[350]=18.70828693387,[352]=18.761663039294,[353]=18.788294228056,[354]=18.814887722227,[355]=18.841443681417,[356]=18.867962264113,[357]=18.894443627691,[2406]=49.050993873723,[2408]=49.071376585541,[2409]=49.081564767232,[362]=19.02629759044,[2411]=49.101934788764,[364]=19.078784028339,[2413]=49.122296363261,[366]=19.131126469709,[2417]=49.162994213127,[370]=19.235384061671,[2419]=49.183330509432,[372]=19.287301521986,[2421]=49.20365840057,[374]=19.339079605814,[376]=19.390719429665,[2425]=49.244289008981,[2426]=49.254441424099,[2427]=49.264591747014,[2429]=49.284886121406,[382]=19.544820285692,[384]=19.595917942265,[2433]=49.325449820554,[386]=19.646882704388,[387]=19.672315572906,[388]=19.697715603592,[2437]=49.36598018879,[390]=19.748417658131,[392]=19.798989873223,[2441]=49.406477308142,[394]=19.849433241279,[395]=19.874606914352,[396]=19.899748742132,[397]=19.924858845171,[398]=19.94993734326,[2448]=49.477267507412,[401]=20.024984394501,[402]=20.049937655763,[2451]=49.507575177946,[404]=20.099751242242,[2453]=49.527769988159,[406]=20.14944167961,[408]=20.199009876724,[409]=20.223748416157,[410]=20.248456731317,[411]=20.273134932713,[413]=20.322401432902,[414]=20.346989949376,[416]=20.396078054371,[417]=20.420577856662,[2466]=49.658836071741,[419]=20.469489490459,[2468]=49.678969393497,[2469]=49.689032995219,[2470]=49.699094559157,[424]=20.591260281974,[425]=20.615528128088,[2474]=49.739320461784,[427]=20.663978319772,[2476]=49.759421218499,[429]=20.712315177208,[2478]=49.779513858615,[432]=20.784609690827,[433]=20.808652046685,[2482]=49.819674828325,[435]=20.856653614614,[2484]=49.839743177508,[437]=20.904544960367,[2486]=49.859803449272,[440]=20.976176963403,[2489]=49.889878733066,[2490]=49.899899799499,[443]=21.047565179849,[445]=21.095023109729,[446]=21.118712081943,[449]=21.189620100417,[2498]=49.979995998399,[451]=21.236760581595,[2500]=50.0,[453]=21.283796653793,[454]=21.307275752663,[456]=21.354156504063,[457]=21.377558326432,[458]=21.400934559033,[459]=21.424285285629,[460]=21.447610589527,[461]=21.470910553584,[462]=21.494185260205,[464]=21.540659228538,[465]=21.563858652848,[2514]=50.139804546887,[467]=21.610182784974,[468]=21.633307652784,[469]=21.656407827708,[470]=21.679483388679,[472]=21.7255609824,[473]=21.748563170932,[474]=21.771541057077,[2523]=50.229473419497,[2525]=50.249378105604,[478]=21.863211109075,[480]=21.908902300207,[2529]=50.289163842721,[482]=21.9544984001,[2531]=50.309044912421,[2532]=50.318982501636,[485]=22.022715545545,[486]=22.045407685049,[488]=22.090722034375,[2537]=50.368641037852,[490]=22.135943621179,[491]=22.15851980616,[492]=22.181073012819,[2541]=50.408332644514,[494]=22.226110770893,[497]=22.293496809608,[498]=22.315913604421,[2547]=50.467811523782,[500]=22.360679774998,[2549]=50.487622245457,[502]=22.405356502408,[504]=22.449944320644,[505]=22.472205054244,[506]=22.494443758404,[507]=22.516660498395,[509]=22.561028345357,[510]=22.583179581272,[512]=22.62741699797,[2561]=50.60632371552,[514]=22.671568097509,[515]=22.69361143582,[516]=22.715633383201,[517]=22.737634001804,[518]=22.759613353482,[520]=22.803508501983,[521]=22.825424421027,[522]=22.847319317592,[523]=22.869193252059,[524]=22.891046284519,[525]=22.912878474779,[526]=22.934689882359,[528]=22.978250586152,[2577]=50.764160585988,[530]=23.021728866443,[531]=23.043437243606,[532]=23.065125189342,[533]=23.08679276123,[2582]=50.81338406365,[2584]=50.833060108555,[537]=23.173260452513,[2586]=50.852728540364,[539]=23.216373532488,[541]=23.259406699226,[2590]=50.892042599998,[2592]=50.911688245431,[545]=23.345235059858,[2594]=50.931326312987,[547]=23.388031127053,[548]=23.409399821439,[549]=23.43074902772,[2598]=50.970579749499,[2600]=50.990195135928,[553]=23.51595203261,[554]=23.53720459188,[555]=23.558437978779,[556]=23.579652245103,[557]=23.600847442412,[558]=23.622023622035,[560]=23.664319132398,[561]=23.685438564654,[2610]=51.088159097779,[563]=23.727621035409,[564]=23.748684174076,[565]=23.769728648009,[566]=23.790754506741,[568]=23.832750575626,[569]=23.853720883753,[570]=23.874672772627,[571]=23.895606290697,[573]=23.937418407172,[574]=23.958297101422,[2624]=51.224993899463,[577]=24.020824298929,[578]=24.041630560343,[579]=24.062418831032,[580]=24.083189157585,[581]=24.103941586388,[582]=24.12467616363,[584]=24.166091947189,[585]=24.186773244896,[586]=24.20743687382,[587]=24.228082879171,[588]=24.248711305964,[589]=24.269322199023,[590]=24.289915602982,[592]=24.331050121193,[2641]=51.390660630118,[594]=24.372115213908,[2643]=51.410115736108,[596]=24.413111231467,[2645]=51.429563482495,[598]=24.454038521275,[600]=24.494897427832,[2649]=51.468436929831,[602]=24.535688292771,[2651]=51.487862647424,[2653]=51.507281038704,[606]=24.617067250182,[608]=24.657656011876,[609]=24.677925358506,[610]=24.698178070457,[611]=24.718414188617,[612]=24.738633753706,[2661]=51.584881506116,[614]=24.779023386728,[616]=24.819347291982,[617]=24.839484696748,[618]=24.859605789312,[619]=24.879710609249,[620]=24.899799195977,[621]=24.919871588754,[622]=24.93992782668,[2673]=51.701063818842,[626]=25.019992006394,[627]=25.039968051098,[628]=25.059928172283,[629]=25.079872407969,[630]=25.099800796022,[632]=25.139610179953,[633]=25.159491250818,[634]=25.179356624028,[635]=25.199206336708,[637]=25.238858928248,[638]=25.25866188063,[640]=25.298221281347,[641]=25.317977802344,[642]=25.33771891864,[643]=25.357444666212,[644]=25.377155080899,[645]=25.396850198401,[646]=25.416530054278,[648]=25.455844122716,[649]=25.475478405714,[650]=25.495097567964,[651]=25.514701644346,[2700]=51.961524227066,[653]=25.553864678361,[2702]=51.980765673468,[656]=25.612496949731,[657]=25.632011235953,[2706]=52.01922721456,[659]=25.670995305987,[2708]=52.038447325031,[661]=25.709920264365,[662]=25.729360660537,[664]=25.76819745345,[665]=25.787593916455,[2714]=52.096065110524,[667]=25.82634314029,[669]=25.865034312755,[670]=25.88435821109,[672]=25.922962793631,[673]=25.942243542146,[674]=25.961509971494,[675]=25.980762113533,[2724]=52.1919534028,[677]=26.019223662515,[678]=26.038433132583,[680]=26.076809620811,[681]=26.0959767014,[682]=26.115129714401,[683]=26.134268690744,[684]=26.153393661244,[685]=26.172504656605,[686]=26.191601707418,[688]=26.229754097208,[689]=26.248809496813,[690]=26.267851073127,[691]=26.28687885619,[692]=26.305892875932,[693]=26.324893162176,[694]=26.343879744639,[696]=26.381811916546,[697]=26.400757564888,[698]=26.419689627246,[699]=26.438608132805,[701]=26.476404589747,[702]=26.495282598984,[704]=26.532998322843,[705]=26.551836094704,[706]=26.570660511173,[707]=26.589471600617,[708]=26.6082693913,[709]=26.627053911389,[710]=26.645825188948,[712]=26.683328128253,[2761]=52.545218621679,[714]=26.720778431775,[2763]=52.564246403806,[716]=26.758176320519,[2765]=52.58326730054,[718]=26.795522013949,[720]=26.832815729997,[2769]=52.621288467691,[722]=26.870057685089,[723]=26.888659319498,[724]=26.907248094147,[725]=26.925824035673,[726]=26.944387170615,[728]=26.981475126464,[2777]=52.697248505022,[730]=27.018512172213,[731]=27.037011669192,[733]=27.073972741362,[734]=27.092434368288,[736]=27.129319932501,[737]=27.147743920996,[738]=27.166155414412,[739]=27.184554438136,[740]=27.202941017471,[741]=27.221315177632,[742]=27.239676943752,[744]=27.276363393972,[745]=27.294688127912,[746]=27.313000567495,[747]=27.331300737433,[748]=27.349588662355,[749]=27.367864366808,[750]=27.386127875258,[753]=27.440845468024,[754]=27.459060435492,[755]=27.477263328068,[756]=27.495454169735,[757]=27.513632984395,[758]=27.531799795872,[760]=27.56809750418,[761]=27.586228448267,[762]=27.604347483685,[763]=27.622454633866,[765]=27.658633371879,[766]=27.676705006196,[768]=27.712812921102,[769]=27.730849247724,[770]=27.748873851023,[771]=27.76688675383,[772]=27.7848879789,[773]=27.802877548916,[2822]=53.122499941174,[2824]=53.141321022346,[777]=27.874719729533,[2826]=53.160135440008,[779]=27.910571473906,[780]=27.928480087538,[781]=27.946377224964,[782]=27.964262908219,[2832]=53.2165387826,[785]=28.017851452244,[786]=28.035691537752,[787]=28.053520278211,[788]=28.071337695236,[789]=28.089143810376,[790]=28.10693864511,[792]=28.142494558941,[793]=28.160255680657,[794]=28.178005607211,[795]=28.195744359743,[797]=28.231188426986,[798]=28.248893783651,[800]=28.284271247462,[801]=28.30194339617,[802]=28.319604517013,[803]=28.33725463061,[804]=28.354893757516,[805]=28.372521918222,[806]=28.390139133157,[808]=28.425340807104,[809]=28.442925306656,[810]=28.460498941515,[811]=28.478061731796,[812]=28.49561369755,[813]=28.513154858767,[814]=28.530685235374,[816]=28.565713714171,[817]=28.583211855913,[818]=28.60069929215,[819]=28.618176042508,[820]=28.635642126553,[821]=28.653097563789,[822]=28.670542373663,[0]=0.0,[824]=28.705400188815,[825]=28.72281323269,[826]=28.7402157264,[827]=28.757607689097,1.0,[829]=28.792360097776,[830]=28.809720581776,[3]=1.7320508075689,[832]=28.844410203712,[833]=28.861739379324,[834]=28.879058156387,[2883]=53.693575034635,[836]=28.913664589602,[2885]=53.712196007983,[838]=28.94822965226,[4]=2.0,[840]=28.982753492379,[2889]=53.749418601507,[842]=29.017236257094,[843]=29.034462281916,[844]=29.051678092668,[845]=29.068883707497,[846]=29.086079144498,[6]=2.4494897427832,[848]=29.120439557122,[849]=29.137604568667,[850]=29.154759474227,[851]=29.17190429163,[852]=29.189039038653,[853]=29.20616373302,[854]=29.223278392405,[8]=2.8284271247462,[856]=29.257477676656,[857]=29.274562336609,[858]=29.291637031754,[859]=29.308701779506,[12]=3.4641016151378,[861]=29.342801502242,[862]=29.359836511806,[9]=3.0,[864]=29.393876913398,[865]=29.410882339705,[866]=29.427877939124,[867]=29.444863728671,[868]=29.461839725312,[869]=29.478805945967,[870]=29.495762407505,[10]=3.1622776601684,[872]=29.529646120467,[873]=29.546573405388,[874]=29.563490998189,[875]=29.580398915498,[876]=29.597297173897,[877]=29.614185789922,[878]=29.631064780058,[13]=3.605551275464,[22]=4.6904157598234,[881]=29.681644159312,[882]=29.698484809835,[883]=29.715315916207,[884]=29.732137494637,[885]=29.748949561287,[886]=29.765752132274,[16]=4.0,[888]=29.799328851503,[889]=29.816103031751,[890]=29.832867780353,[891]=29.849623113199,[17]=4.1231056256177,[893]=29.883105594968,[894]=29.899832775452,[18]=4.2426406871193,[896]=29.933259094192,[897]=29.949958263744,[2946]=54.277066980448,[899]=29.98332870113,[2948]=54.295487841993,[901]=30.016662039607,[902]=30.033314835362,[20]=4.4721359549996,[904]=30.066592756746,[905]=30.083217912983,[906]=30.099833886585,[907]=30.116440692751,[908]=30.133038346639,[909]=30.149626863363,[910]=30.166206257997,[21]=4.5825756949558,[912]=30.199337741083,[913]=30.215889859476,[914]=30.232432915662,[915]=30.248966924508,[916]=30.265491900843,[917]=30.282007859453,[918]=30.298514815086,[25]=5.0,[920]=30.331501776206,[921]=30.347981810987,[922]=30.364452901378,[923]=30.380915061927,[29]=5.3851648071345,[925]=30.413812651491,[926]=30.430248109406,[30]=5.4772255750517,[928]=30.463092423456,[929]=30.479501308256,[930]=30.495901363954,[931]=30.512292604785,[932]=30.528675044947,[933]=30.545048698603,[934]=30.561413579872,[33]=5.744562646538,[936]=30.594117081557,[937]=30.610455730028,[938]=30.626785662227,[939]=30.643106892089,[940]=30.659419433512,[941]=30.675723300356,[942]=30.692018506446,[34]=5.8309518948453,[944]=30.724582991474,[945]=30.740852297879,[946]=30.757112998459,[947]=30.773365106858,[948]=30.789608636681,[949]=30.805843601499,[950]=30.822070014845,[35]=5.9160797830996,[952]=30.854497241083,[953]=30.870698080866,[954]=30.886890422961,[955]=30.903074280725,[43]=6.557438524302,[957]=30.935416596516,[958]=30.951575081084,[42]=6.4807406984079,[36]=6.0,[3009]=54.85435260761,[962]=31.016124838542,[963]=31.032241298366,[964]=31.04834939252,[965]=31.064449134018,[966]=31.08054053584,[37]=6.0827625302982,[968]=31.112698372208,[969]=31.128764832547,[970]=31.144823004795,[971]=31.160872901766,[972]=31.17691453624,[973]=31.192947920964,[974]=31.208973068654,[38]=6.164414002969,[976]=31.240998703627,[977]=31.256999216176,[978]=31.272991542224,[979]=31.288975694324,[980]=31.304951684997,[981]=31.320919526732,[982]=31.336879231985,[41]=6.4031242374328,[984]=31.368774282716,[985]=31.38470965295,[986]=31.400636936215,[987]=31.41655614481,[45]=6.7082039324994,[989]=31.448370387033,[990]=31.464265445105,[52]=7.211102550928,[992]=31.496031496047,[993]=31.511902513177,[994]=31.527765540869,[995]=31.543620591175,[996]=31.559467676119,[997]=31.575306807694,[998]=31.591137997863,[61]=7.8102496759067,[1000]=31.622776601684,[1001]=31.638584039113,[1002]=31.654383582689,[1003]=31.670175244226,[1004]=31.68595903551,[1005]=31.701734968295,[1006]=31.717503054307,[70]=8.3666002653408,[76]=8.7177978870813,[1009]=31.764760348537,[1010]=31.780497164141,[1011]=31.796226191169,[1012]=31.811947441174,[1013]=31.827660925679,[1014]=31.843366656181,[88]=9.3808315196469,[1016]=31.874754901018,[1017]=31.890437438204,[1018]=31.906112267088,[1019]=31.921779399025,[49]=7.0,[1021]=31.953090617341,[1022]=31.968734726292,[51]=7.1414284285429,[3072]=55.425625842204,[1025]=32.015621187164,[1026]=32.031234756094,[1027]=32.046840717924,[1028]=32.062439083763,[1029]=32.078029864691,[1030]=32.093613071762,[53]=7.2801098892805,[1032]=32.124756808418,[1033]=32.140317359976,[1034]=32.155870381627,[1035]=32.171415884291,[1036]=32.186953878862,[1037]=32.202484376209,[1038]=32.218007387174,[54]=7.3484692283495,[1040]=32.249030993194,[1041]=32.264531609803,[1042]=32.280024783138,[1043]=32.29551052391,[1044]=32.310988842807,[1045]=32.326459750489,[1046]=32.341923257592,[57]=7.5498344352707,[1048]=32.372828112477,[1049]=32.388269481403,[1050]=32.403703492039,[1051]=32.419130154895,[58]=7.6157731058639,[1053]=32.449961479176,[1054]=32.465366161496,[67]=8.1853527718725,[1056]=32.496153618544,[1057]=32.511536414018,[1058]=32.526911934581,[1059]=32.542280190546,[1060]=32.557641192199,[1061]=32.572994949805,[1062]=32.588341473601,[75]=8.6602540378444,[1064]=32.6190128606,[1065]=32.634337744161,[1066]=32.649655434629,[1067]=32.664965942122,[1068]=32.680269276736,[1069]=32.695565448544,[1070]=32.710854467592,[78]=8.8317608663278,[1072]=32.74141108749,[1073]=32.756678708318,[1074]=32.771939216348,[1075]=32.78719262151,[1076]=32.802438933713,[1077]=32.817678162844,[1078]=32.832910318764,[64]=8.0,[1080]=32.86335345031,[1081]=32.878564445547,[1082]=32.893768406797,[1083]=32.908965343809,[65]=8.0622577482985,[1085]=32.939338184001,[1086]=32.954514106568,[66]=8.124038404636,[1088]=32.984845004941,[1089]=33.0,[1090]=33.015148038438,[1091]=33.030289129827,[1092]=33.045423283717,[1093]=33.060550509633,[1094]=33.075670817082,[69]=8.3066238629181,[1096]=33.105890714494,[1097]=33.120990323358,[1098]=33.136083051562,[1099]=33.151168908502,[1100]=33.166247903554,[1101]=33.181320046074,[1102]=33.196385345396,[72]=8.4852813742386,[1104]=33.226495451672,[1105]=33.241540277189,[1106]=33.256578296632,[1107]=33.271609519228,[1108]=33.286633954186,[1109]=33.301651610693,[1110]=33.316662497915,[73]=8.5440037453175,[1112]=33.346664001066,[1113]=33.361654635225,[1114]=33.376638536557,[1115]=33.391615714128,[77]=8.7749643873921,[1117]=33.421549934137,[1118]=33.436506994601,[84]=9.1651513899117,[1120]=33.466401061363,[1121]=33.481338085566,[1122]=33.496268448888,[1123]=33.511192160232,[1124]=33.52610922848,[1125]=33.541019662497,[1126]=33.555923471125,[96]=9.7979589711327,[1128]=33.585711247493,[1129]=33.600595232823,[1130]=33.615472627943,[1131]=33.6303434416,[1132]=33.645207682521,[1133]=33.660065359414,[1134]=33.674916480965,[93]=9.643650760993,[114]=10.677078252031,[1137]=33.719430600175,[1138]=33.734255586866,[1139]=33.749074061372,[1140]=33.763886032268,[1141]=33.778691508109,[1142]=33.793490497432,[128]=11.313708498985,[1144]=33.823069050576,[1145]=33.837848631377,[1146]=33.852621759622,[1147]=33.867388443752,[81]=9.0,[1149]=33.896902513357,[1150]=33.911649915626,[83]=9.1104335791443,[1152]=33.941125496954,[1153]=33.955853692699,[1154]=33.970575502926,[1155]=33.985290935933,[1156]=34.0,[1157]=34.01470270339,[1158]=34.029399054347,[85]=9.2195444572929,[1160]=34.058772731853,[1161]=34.073450074802,[1162]=34.088121098119,[1163]=34.10278580996,[1164]=34.117444218464,[1165]=34.132096331752,[1166]=34.146742157928,[86]=9.2736184954957,[1168]=34.17601498127,[1169]=34.190641994558,[1170]=34.205262752974,[1171]=34.219877264537,[1172]=34.234485537247,[1173]=34.249087579087,[1174]=34.263683398024,[90]=9.4868329805051,[1176]=34.292856398964,[1177]=34.307433596817,[1178]=34.322004603461,[1179]=34.336569426779,[94]=9.6953597148327,[1181]=34.365680554879,[1182]=34.380226875342,[99]=9.9498743710662,[1184]=34.409301068171,[1185]=34.423828956117,[1186]=34.438350715445,[1187]=34.452866353904,[1188]=34.467375879228,[1189]=34.481879299133,[1190]=34.496376621321,[97]=9.8488578017961,[1192]=34.525353003264,[1193]=34.539832078341,[1194]=34.554305086342,[1195]=34.568772034887,[1196]=34.583232931581,[1197]=34.597687784012,[1198]=34.612136599754,[98]=9.8994949366117,[1200]=34.641016151378,[1201]=34.655446902327,[1202]=34.669871646719,[1203]=34.684290392049,[1204]=34.698703145795,[1205]=34.71310991542,[1206]=34.727510708371,[106]=10.295630140987,[1208]=34.756294393966,[1209]=34.770677301427,[1210]=34.785054261852,[1211]=34.799425282611,[115]=10.723805294764,[1213]=34.828149534536,[1214]=34.842502780369,[133]=11.532562594671,[1216]=34.871191548325,[1217]=34.885527085025,[1218]=34.89985673323,[1219]=34.914180500192,[1220]=34.928498393146,[1221]=34.942810419312,[1222]=34.957116585897,[163]=12.767145334804,[1224]=34.985711369072,[1225]=35.0,[1226]=35.014282800023,[1227]=35.028559776274,[1228]=35.04283093587,[1229]=35.057096285916,[1230]=35.0713558335,[100]=10.0,[1232]=35.099857549568,[1233]=35.114099732159,[1234]=35.128336140501,[1235]=35.142566781611,[1236]=35.156791662494,[1237]=35.171010790138,[1238]=35.185224171518,[101]=10.049875621121,[1240]=35.213633723318,[1241]=35.227829907617,[1242]=35.242020373412,[1243]=35.256205127608,[102]=10.099504938362,[1245]=35.284557528755,[1246]=35.298725189446,[104]=10.198039027186,[1248]=35.327043465311,[1249]=35.341194094145,[1250]=35.355339059327,[1251]=35.369478367655,[1252]=35.383612025908,[1253]=35.397740040856,[1254]=35.411862419252,[105]=10.24695076596,[1256]=35.440090293339,[1257]=35.454195802472,[1258]=35.468295701936,[1259]=35.48238999842,[1260]=35.496478698598,[1261]=35.510561809129,[1262]=35.524639336663,[110]=10.488088481702,[113]=10.630145812735,[1265]=35.566838487557,[1266]=35.580893749314,[1267]=35.594943461115,[1268]=35.60898762953,[1269]=35.623026261114,[1270]=35.637059362411,[118]=10.8627804912,[1272]=35.665109000254,[1273]=35.679125549823,[1274]=35.693136595149,[1275]=35.707142142714,[120]=10.954451150103,[1277]=35.735136770411,[1278]=35.749125863439,[132]=11.489125293076,[1280]=35.777087639997,[1281]=35.791060336347,[1282]=35.805027579936,[1283]=35.818989377145,[1284]=35.832945734338,[1285]=35.84689665787,[1286]=35.860842154082,[136]=11.661903789691,[1288]=35.888716889853,[1289]=35.902646142032,[1290]=35.916569992136,[1291]=35.930488446443,[1292]=35.944401511223,[1293]=35.95830919273,[1294]=35.97221149721,[165]=12.845232578665,[1296]=36.0,[1297]=36.013886210738,[1298]=36.027767069304,[1299]=36.04164258188,[1300]=36.05551275464,[1301]=36.069377593743,[1302]=36.083237105337,[121]=11.0,[1304]=36.110940170536,[1305]=36.124783736377,[1306]=36.138621999185,[1307]=36.15245496505,[126]=11.224972160322,[1309]=36.180105030251,[1310]=36.193922141708,[130]=11.401754250991,[1312]=36.22154055255,[1313]=36.235341863987,[1314]=36.249137920784,[1315]=36.262928728937,[1316]=36.276714294434,[1317]=36.290494623248,[1318]=36.304269721343,[134]=11.57583690279,[1320]=36.33180424917,[1321]=36.345563690772,[1322]=36.359317925396,[1323]=36.373066958946,[1324]=36.386810797321,[1325]=36.400549446403,[1326]=36.414282912066,[139]=11.789826122552,[1328]=36.441734316577,[1329]=36.455452267116,[1330]=36.469165057621,[1331]=36.482872693909,[1332]=36.496575181789,[1333]=36.510272527057,[1334]=36.523964735499,[137]=11.70469991072,[1336]=36.551333764994,[1337]=36.565010597564,[1338]=36.578682316344,[1339]=36.592348927064,[138]=11.747340124471,[1341]=36.619666847201,[1342]=36.633318168028,[141]=11.874342087038,[1344]=36.660605559647,[1345]=36.674241641784,[1346]=36.687872655688,[1347]=36.701498607005,[1348]=36.715119501372,[1349]=36.728735344414,[1350]=36.742346141748,[147]=12.124355652982,[1352]=36.7695526217,[1353]=36.783148315499,[1354]=36.796738985948,[1355]=36.810324638612,[1356]=36.823905279044,[1357]=36.837480912788,[1358]=36.851051545377,[144]=12.0,[1360]=36.878177829172,[1361]=36.891733491393,[1362]=36.905284174492,[1363]=36.918829883949,[1364]=36.932370625239,[1365]=36.945906403822,[1366]=36.959437225153,[145]=12.041594578792,[1368]=36.986484017814,[1369]=37.0,[1370]=37.013511046643,[1371]=37.027017163147,[146]=12.083045973595,[1373]=37.054014627298,[1374]=37.067505985701,[152]=12.328828005938,[1376]=37.094473981983,[1377]=37.107950630559,[1378]=37.121422386541,[1379]=37.134889255254,[1380]=37.148351242013,[1381]=37.161808352124,[1382]=37.175260590882,[153]=12.369316876853,[1384]=37.202150475477,[1385]=37.215588131857,[1386]=37.229020937973,[154]=12.409673645991,[1388]=37.255872020394,[1389]=37.269290307168,[1390]=37.282703764614,[157]=12.529964086142,[162]=12.727922061358,[1393]=37.322915213043,[1394]=37.336309405189,[1395]=37.349698793966,[1396]=37.363083384539,[1397]=37.376463182062,[1398]=37.38983819168,[160]=12.649110640674,[1400]=37.416573867739,[1401]=37.429934544426,[1402]=37.443290453698,[1403]=37.456641600656,[181]=13.453624047074,[1405]=37.483329627983,[1406]=37.496666518505,[193]=13.89244398945,[1408]=37.523326078587,[1409]=37.536648758247,[1410]=37.549966711037,[1411]=37.563279941986,[1412]=37.576588456112,[1413]=37.589892258425,[1414]=37.603191353926,[202]=14.212670403552,[1416]=37.629775444454,[1417]=37.643060449437,[1418]=37.656340767525,[1419]=37.669616403675,[1420]=37.682887362834,[1421]=37.696153649942,[1422]=37.70941526993,[217]=14.730919862656,[1424]=37.735924528226,[1425]=37.749172176354,[1426]=37.762415176998,[1427]=37.775653535048,[1428]=37.788887255382,[1429]=37.802116342872,[1430]=37.815340802378,[244]=15.620499351813,[1432]=37.841775856849,[1433]=37.854986461495,[1434]=37.868192457523,[1435]=37.881393849752,[253]=15.905973720587,[1437]=37.90778284205,[1438]=37.920970451717,[304]=17.435595774163,[1440]=37.947331922021,[1441]=37.960505792205,[1442]=37.973675092095,[1443]=37.986839826445,[1444]=38.0,[1445]=38.013155617496,[1446]=38.026306683663,[169]=13.0,[1448]=38.052595180881,[1449]=38.065732621349,[1450]=38.07886552932,[1451]=38.091993909482,[1452]=38.105117766515,[1453]=38.118237105092,[1454]=38.131351929875,[171]=13.076696830622,[174]=13.190905958273,[1457]=38.170669367985,[1458]=38.183766184074,[1459]=38.196858509569,[1460]=38.209946349086,[1461]=38.223029707233,[1462]=38.23610858861,[177]=13.30413469565,[1464]=38.262252939418,[1465]=38.275318418009,[1466]=38.288379438153,[1467]=38.301436004411,[178]=13.341664064126,[1469]=38.327535793474,[1470]=38.340579025362,[189]=13.747727084868,[194]=13.928388277184,[1473]=38.379682124791,[1474]=38.392707640905,[1475]=38.405728739343,[1476]=38.418745424597,[1477]=38.431757701151,[1478]=38.444765573482,[195]=13.964240043769,[1480]=38.470768123343,[1481]=38.483762809788,[1482]=38.49675310984,[1483]=38.509739027939,[1484]=38.522720568516,[1485]=38.535697735995,[1486]=38.548670534793,[210]=14.491376746189,[1488]=38.574603043972,[1489]=38.587562763149,[1490]=38.600518131238,[1491]=38.613469152616,[1492]=38.626415831656,[1493]=38.639358172723,[1494]=38.652296180175,[218]=14.764823060233,[1496]=38.678159211627,[1497]=38.691084244306,[1498]=38.704004960727,[1499]=38.716921365212,[267]=16.340134638368,[1501]=38.742741255621,[1502]=38.755644750152,[196]=14.0,[1504]=38.781438859331,[1505]=38.794329482542,[1506]=38.807215823865,[1507]=38.820097887563,[1508]=38.832975677895,[1509]=38.84584919911,[1510]=38.858718455451,[198]=14.07124727947,[1512]=38.884444190447,[1513]=38.897300677553,[1514]=38.910152916687,[1515]=38.923000912057,[200]=14.142135623731,[1517]=38.948684188301,[1518]=38.961519477556,[201]=14.177446878758,[204]=14.282856857086,[1521]=39.0,[1522]=39.012818406262,[1523]=39.025632602176,[1524]=39.038442591886,[1525]=39.051248379533,[1526]=39.064049969249,[206]=14.352700094407,[1528]=39.089640571384,[1529]=39.102429592034,[1530]=39.115214431216,[1531]=39.127995093028,[214]=14.628738838328,[1533]=39.153543900904,[1534]=39.166312055132,[212]=14.560219778561,[1536]=39.191835884531,[1537]=39.204591567825,[1538]=39.217343102255,[1539]=39.230090491866,[1540]=39.242833740697,[1541]=39.255572852781,[1542]=39.268307832144,[213]=14.594519519326,[1544]=39.293765408777,[1545]=39.306488014067,[1546]=39.319206502675,[1547]=39.331920878594,[1548]=39.344631145812,[1549]=39.357337308309,[1550]=39.370039370059,[228]=15.099668870541,[1552]=39.395431207184,[1553]=39.408120990476,[1554]=39.420806688854,[222]=14.899664425751,[1556]=39.446165846632,[1557]=39.458839313898,[1558]=39.471508711981,[237]=15.394804318341,[1560]=39.496835316263,[1561]=39.509492530277,[1562]=39.522145690739,[1563]=39.534794801542,[236]=15.362291495737,[1565]=39.560080889705,[1566]=39.572717874819,[249]=15.779733838059,[1568]=39.597979746447,[1569]=39.610604640677,[1570]=39.623225512318,[1571]=39.635842365213,[1572]=39.648455203198,[1573]=39.661064030104,[1574]=39.673668849755,[312]=17.663521732656,[1576]=39.698866482558,[1577]=39.71145930333,[1578]=39.724048132082,[1579]=39.736632972611,[1580]=39.749213828704,[1581]=39.761790704142,[1582]=39.774363602703,[225]=15.0,[1584]=39.799497484265,[1585]=39.812058474789,[1586]=39.82461550348,[1587]=39.837168574084,[226]=15.033296378373,[1589]=39.862262855989,[1590]=39.874804074754,[234]=15.297058540778,[1592]=39.89987468652,[1593]=39.91240408695,[1594]=39.924929555354,[1595]=39.937451095432,[235]=15.329709716756,[1597]=39.962482405376,[1598]=39.974992182613,[238]=15.427248620542,[1600]=40.0,[1601]=40.012498047485,[1602]=40.024992192379,[251]=15.842979517755,[1604]=40.049968789002,[1605]=40.06245124802,[1606]=40.074929819028,[254]=15.937377450509,[1608]=40.099875311527,[1609]=40.112342240263,[1610]=40.124805295478,[1611]=40.137264480779,[1612]=40.149719799769,[1613]=40.162171256046,[1614]=40.174618853201,[259]=16.093476939431,[1616]=40.199502484484,[1617]=40.211938525766,[1618]=40.224370722238,[1619]=40.236799077461,[1620]=40.249223594996,[277]=16.643316977093,[1622]=40.274061131205,[283]=16.822603841261,[1624]=40.29888335922,[1625]=40.311288741493,[1626]=40.323690307312,[1627]=40.336088060197,[310]=17.606816861659,[1629]=40.360872141221,[1630]=40.373258476373,[322]=17.944358444926,[1632]=40.398019753448,[1633]=40.410394702353,[1634]=40.422765862815,[1635]=40.435133238311,[1636]=40.447496832313,[1637]=40.459856648288,[1638]=40.472212689696,[403]=20.074859899885,[1640]=40.496913462633,[1641]=40.509258201058,[1642]=40.52159917871,[1643]=40.533936399022,[1644]=40.546269865427,[1645]=40.558599581346,[1646]=40.570925550202,[256]=16.0,[257]=16.031219541881,[1649]=40.607881008494,[1650]=40.62019202318,[1651]=40.63249930782,[1652]=40.644802865803,[1653]=40.657102700512,[1654]=40.669398815326,[258]=16.062378404209,[1656]=40.693979898752,[1657]=40.706264874095,[1658]=40.718546143005,[1659]=40.730823708833,[261]=16.155494421404,[1661]=40.75536774463,[1662]=40.767634221279,[265]=16.2788205961,[1664]=40.792156108742,[1665]=40.804411526206,[1666]=40.816663263917,[1667]=40.828911325187,[1668]=40.841155713324,[1669]=40.853396431631,[1670]=40.865633483405,[269]=16.401219466857,[1672]=40.890096600522,[1673]=40.902322672435,[1674]=40.914545090958,[274]=16.552945357247,[1676]=40.938978980917,[1677]=40.951190458887,[1678]=40.963398296528,[273]=16.522711641858,[1680]=40.987803063838,[1681]=41.0,[1682]=41.01219330882,[1683]=41.024382993532,[1684]=41.036569057366,[1685]=41.048751503548,[1686]=41.060930335296,[276]=16.613247725836,[1688]=41.085277168348,[1689]=41.097445176069,[1690]=41.109609582189,[1691]=41.121770389904,[281]=16.76305461424,[1693]=41.146081222882,[1694]=41.158231254513,[301]=17.349351572897,[317]=17.804493814765,[1697]=41.194659848092,[1698]=41.206795556073,[1699]=41.21892769105,[1700]=41.231056256177,[1701]=41.243181254603,[1702]=41.255302689473,[336]=18.330302779823,[1704]=41.279534881101,[1705]=41.291645644125,[1706]=41.303752856127,[1707]=41.315856520227,[1708]=41.327956639544,[1709]=41.340053217189,[1710]=41.352146256271,[346]=18.601075237738,[1712]=41.376321731154,[1713]=41.38840417315,[1714]=41.400483088969,[1715]=41.412558481697,[1716]=41.424630354416,[289]=17.0,[1718]=41.448763552125,[297]=17.233687939614,[1720]=41.472882706655,[1721]=41.484937025383,[1722]=41.496987842493,[1723]=41.509035161035,[298]=17.262676501632,[1725]=41.53311931459,[1726]=41.545156155682,[306]=17.492855684536,[1728]=41.569219381653,[1729]=41.581245772584,[1730]=41.593268686171,[1731]=41.605288125429,[1732]=41.61730409337,[1733]=41.629316592997,[1734]=41.641325627314,[315]=17.748239349299,[1736]=41.665333311999,[1737]=41.677331968349,[1738]=41.689327171352,[1739]=41.701318923986,[318]=17.832554500127,[1741]=41.72529209005,[1742]=41.737273509418,[330]=18.165902124585,[1744]=41.761226035642,[1745]=41.773197148411,[1746]=41.785164831552,[1747]=41.797129088013,[1748]=41.809089920734,[1749]=41.821047332653,[1750]=41.833001326704,[438]=20.928449536456,[1752]=41.856899072913,[1753]=41.868842830917,[1754]=41.880783182744,[1755]=41.892720131307,[324]=18.0,[1757]=41.916583830269,[1758]=41.928510586473,[328]=18.110770276275,[1760]=41.952353926806,[1761]=41.964270516715,[1762]=41.976183723631,[1763]=41.988093550434,[1764]=42.0,[1765]=42.0119030752,[1766]=42.023802778901,[337]=18.357559750686,[342]=18.493242008907,[1769]=42.059481689626,[1770]=42.071367935925,[1771]=42.083250825002,[1772]=42.095130359698,[1773]=42.107006542855,[358]=18.920887928425,[360]=18.97366596101,[385]=19.621416870349,[1777]=42.154477816716,[1778]=42.166337284616,[1779]=42.178193417926,[373]=19.313207915828,[1781]=42.201895692018,[1782]=42.213741838411,[389]=19.723082923316,[1784]=42.237424163886,[1785]=42.249260348555,[421]=20.518284528683,[1787]=42.272922775697,[430]=20.736441353328,[1789]=42.296571965113,[1790]=42.308391602612,[428]=20.688160865577,[652]=25.534290669607,[1793]=42.34383071948,[1794]=42.355637169095,[1795]=42.36744032863,[1796]=42.379240200834,[1797]=42.391036788453,[1798]=42.402830094228,[361]=19.0,[1800]=42.426406871193,[1801]=42.438190347846,[1802]=42.449970553582,[1803]=42.461747491124,[1804]=42.473521163191,[1805]=42.485291572496,[1806]=42.497058721752,[363]=19.052558883258,[1808]=42.520583250939,[1809]=42.532340636273,[365]=19.104973174543,[1811]=42.555845661906,[1812]=42.567593307586,[369]=19.209372712299,[1814]=42.591078878094,[371]=19.261360284258,[1816]=42.614551505325,[1817]=42.626282971894,[1818]=42.638011210656,[1819]=42.649736224272,[379]=19.467922333932,[1821]=42.673176586704,[1822]=42.684891940826,[377]=19.416487838948,[1824]=42.708313008125,[1825]=42.720018726588,[1826]=42.731721238443,[1827]=42.743420546325,[1828]=42.755116652864,[1829]=42.766809560686,[1830]=42.778499272415,[378]=19.442222095224,[1832]=42.801869118065,[1833]=42.813549257215,[1834]=42.825226210728,[381]=19.519221295943,[1836]=42.848570571257,[1837]=42.860237983474,[1838]=42.871902220452,[393]=19.824227601599,[422]=20.542638584174,[1841]=42.90687590585,[1842]=42.91852746775,[1843]=42.930175867331,[1844]=42.941821107168,[1845]=42.953463189829,[1846]=42.965102117882,[483]=21.977260975836,[595]=24.392621835301,[1849]=43.0,[1850]=43.011626335213,[1851]=43.023249528598,[400]=20.0,[1853]=43.046486500062,[1854]=43.058100283222,[405]=20.124611797498,[1856]=43.081318457076,[1857]=43.09292285283,[1858]=43.104524124505,[1859]=43.11612227462,[1860]=43.127717305696,[1861]=43.139309220246,[1862]=43.150898020783,[418]=20.445048300261,[1864]=43.174066289846,[1865]=43.185645763378,[1866]=43.19722213291,[420]=20.493901531919,[1868]=43.220365569949,[1869]=43.231932642435,[1870]=43.243496620879,[426]=20.63976744055,[1872]=43.266615305568,[434]=20.832666656,[1874]=43.289721643827,[1875]=43.301270189222,[1876]=43.312815655415,[1877]=43.324358044869,[1878]=43.335897360041,[436]=20.880613017821,[1880]=43.358966777358,[1881]=43.370496884403,[452]=21.260291625469,[1883]=43.393547907494,[544]=23.323807579381,[1885]=43.416586692185,[1886]=43.428101501217,[660]=25.69046515733,[441]=21.0,[1889]=43.462627624201,[1890]=43.474130238568,[442]=21.023796041629,[1892]=43.497126341863,[1893]=43.508619835614,[1894]=43.520110293978,[450]=21.213203435596,[1896]=43.543082114154,[1897]=43.554563480765,[1898]=43.566041821584,[1899]=43.577517139002,[1900]=43.588989435407,[1901]=43.600458713183,[1902]=43.611924974713,[466]=21.587033144923,[475]=21.794494717703,[1905]=43.64630568559,[1906]=43.657759905886,[1907]=43.669211121796,[1908]=43.680659335683,[1909]=43.692104549907,[1910]=43.703546766824,[477]=21.840329667842,[481]=21.931712199461,[1913]=43.737855457258,[1914]=43.749285708455,[1915]=43.760712974082,[499]=22.338307903689,[1917]=43.783558557979,[1918]=43.794976880916,[550]=23.452078799117,[562]=23.706539182259,[1921]=43.829214001622,[1922]=43.840620433566,[1923]=43.852023898561,[1924]=43.863424398923,[1925]=43.874821936961,[1926]=43.886216514983,[484]=22.0,[1928]=43.9089968002,[1929]=43.920382511995,[1930]=43.931765272978,[1931]=43.94314508544,[489]=22.113344387496,[1933]=43.965895873961,[1934]=43.977266854592,[493]=22.203603311175,[1936]=44.0,[1937]=44.011362169331,[1938]=44.02272140611,[501]=22.383029285599,[1940]=44.04543109109,[1941]=44.056781543821,[1942]=44.068129073061,[513]=22.649503305812,[1944]=44.090815370097,[536]=23.15167380558,[1946]=44.113490000226,[1947]=44.12482294582,[552]=23.494680248941,[1949]=44.147480109288,[1950]=44.158804331639,[529]=23.0,[1952]=44.181444068749,[1953]=44.192759587969,[1954]=44.204072210601,[534]=23.108440016583,[1956]=44.226688774992,[538]=23.194827009486,[1958]=44.249293779675,[542]=23.280893453646,[1960]=44.271887242357,[1961]=44.283179650969,[546]=23.366642891096,[603]=24.556058315617,[597]=24.433583445741,[1965]=44.328320518603,[1966]=44.339598554791,[576]=24.0,[1968]=44.362146025638,[1969]=44.373415464668,[1970]=44.384682042344,[1971]=44.395945760846,[593]=24.351591323772,[1973]=44.418464629026,[1974]=44.429719783046,[601]=24.515301344263,[1976]=44.452221541786,[1977]=44.463468150831,[1978]=44.474711915874,[1979]=44.48595283907,[605]=24.596747752498,[1981]=44.508426168536,[1982]=44.519658579104,[613]=24.75883680628,[658]=25.651510676761,[1985]=44.553338819891,[1986]=44.564559910314,[1987]=44.575778176045,[1988]=44.586993619216,[1989]=44.598206241956,[1990]=44.609416046391,[625]=25.0,[1992]=44.631827208843,[1993]=44.643028571099,[1994]=44.654227123532,[1995]=44.665422868255,[1996]=44.676615807377,[1997]=44.687805943009,[1998]=44.698993277254,[654]=25.573423705089,[2000]=44.721359549996,[2001]=44.73253849269,[666]=25.806975801128,[2003]=44.7548880012,[2004]=44.766058571199,[2005]=44.777226354476,[2006]=44.788391353117,[715]=26.739483914242,[2008]=44.810713004816,[2009]=44.82186966203,[2010]=44.83302354292,[2011]=44.844174649557,[676]=26.0,[717]=26.776855677992,[2014]=44.877611344634,[713]=26.702059845637,[721]=26.851443164195,[2017]=44.911023145771,[776]=27.856776554368,[2019]=44.933283877322,[778]=27.892651361963,[2021]=44.955533585978,[2022]=44.966654311834,[729]=27.0,[2024]=44.988887516808,[2025]=45.0,[774]=27.820855486487,[2027]=45.022216737962,[2028]=45.033320996791,[2029]=45.044422518221,[2030]=45.055521304275,[835]=28.8963665536,[898]=29.966648127543,[2033]=45.088801270382,[2034]=45.099889135119,[784]=28.0,[2036]=45.122056690714,[2037]=45.133136385587,[837]=28.930952282979,[841]=29.0,[1024]=32.0,[2041]=45.177427992306,[2042]=45.18849411078,[2043]=45.199557519958,[900]=30.0,[2045]=45.22167621838,[2046]=45.232731511595,[961]=31.0}


local function distance(x, y, z)
  return sqrtCache[(x^2 + y^2 + z^2)]
end

local function magic(R, H, D)
  return 2112 * (R - H) / D
end


local function decodeCoords(index) 
    local y = index//(65*65)
    local x_z = index%(65*65)
    local x = x_z//65
    local z = x_z%65
    return x,y,z
end

local function encodeCoords(x,y,z)
    return y*(65*65)+x*65+z
end
local function packNumber(num, bitlen)
    local r=bit_array.create(bitlen or 19)
    r.data[1]=num
    return r
end

local test=false

local insert = table.insert
local unpack = table.unpack

local function encodeCoords2(x,y,z)
    return y*(33*33)+x*33+z
end

local function visualize()

    --local startEnergy=computer.energy()
    --local start=computer.uptime()

    send("init",hardness, size, elevation, height)
    
    local full = (size*2+1)^2+1
    local progress = 0
        
    if not test then
        foundOre = {}
        local blocks, result
        for x = -size, size do
            for z = -size, size do
            
                Scan.caption = "Scanning ["..tostring((progress/full*100)//1):sub(1,-3).."%]"
                Scan:redraw()
                
                blocks = geolyzer.scan(x, z, elevation, 1, 1, height)
                for i_y = 1, height do
                    result = magic(blocks[i_y], hardness, distance(x, i_y+elevation-1, z))
                    if blocks[i_y] ~= 0 and result > -128 and result < 127 and (result%1 > 0.9998 or result%1 < 0.0002) then
                        insert(foundOre,{x+size, i_y-1, z+size})
                    end
                end
                
                progress=progress+1
                
                os.sleep()
            end
        end
    end
                
    local r = bit_array.create(#foundOre*19+19)
    r:setArray(1,packNumber(#foundOre))
    local pos = 1+19
    for _,v in ipairs(foundOre) do
        r:setArray(pos,packNumber(encodeCoords(unpack(v))))
        pos=pos+19
    end
    send("scan", r:toString())
    
    Scan.caption = "Scan"
    Scan:redraw()
    
    --print("scan time",computer.uptime()-start)
    --print("scan energy",computer.energy()-startEnergy, computer.energy(), computer.maxEnergy())
end


local function clamp(v, min, max)
    return math.max(math.min(max,v),min)
end


local gpu = component.gpu
local fontColor = gpu.getForeground()
local backColor = gpu.getBackground()


-- Данный код сгенерирован программой FormsMaker
-- http://computercraft.ru/topic/1044-sistema-vizualnogo-programmirovaniia-formsmaker/
gpu.setResolution(80.0,25.0)
forms=require("forms")
forms.ignoreAll()

Form1=forms.addForm()
Form1.fontColor=0

Label1=Form1:addLabel(64.0,14.0,"hardness")
Label1.W=8

OreSense=Form1:addLabel(1,1,"OreSense")
OreSense.centered=true
OreSense.color=16777215
OreSense.fontColor=255
OreSense.autoSize=false
OreSense.W=80.0

Label3=Form1:addLabel(3.0,21.0,"connection")
Label3.fontColor=7838207
Label3.W=10

netcardsList=Form1:addList(14.0,22.0,function(_,item)
    card = item
    initSend()
end)
netcardsList.fontColor=7838207
netcardsList.H=4.0
netcardsList.border=1
for address, type in component.list("tunnel") do
    netcardsList:insert(type.."   "..address:sub(1,8),address)
end
for address, type in component.list("modem") do
    netcardsList:insert(type.."   "..address:sub(1,8),address)
end

Scan=Form1:addButton(60.0,8.0,"Scan", function()
    --print("memory diff",computer.freeMemory()-startMemory, computer.totalMemory())
    visualize(hardness,size)
end)
Scan.color=16711680
Scan.fontColor=16776960
Scan.H=5.0
Scan.W=18.0

Label4=Form1:addLabel(5.0,23.0,"networkcard")
Label4.alignRight=true
Label4.H=2
Label4.autoSize=false
Label4.W=8

Label5=Form1:addLabel(36.0,23.0,"port")
Label5.W=4

portEdit=Form1:addEdit(41.0,22.0, function(e)
    local ok, r = pcall(tonumber,e.text)
    if ok then
        port=r
        initSend()
    end
    e.text=tostring(port)
    e:redraw()
end)
portEdit.fontColor=7838207
portEdit.text=tostring(port)
portEdit.W=16.0

Label6=Form1:addLabel(3.0,3.0,"scaning area")
Label6.fontColor=7838207
Label6.W=12

Frame1=Form1:addFrame(2.0,4.0,1)
Frame1.H=17.0
Frame1.W=55.0

Label8=Frame1:addLabel(27.0,9.0,"You")
Label8.fontColor=7838207
Label8.W=3

Label9=Frame1:addLabel(28.0,10.0,"▲│││││▼││")
Label9.H=7
Label9.autoSize=false
Label9.W=2

Label12=Frame1:addLabel(22.0,2.0,"▲│││││││││││││▼││")
Label12.H=15
Label12.autoSize=false
Label12.W=2

Label13=Frame1:addLabel(5.0,9.0,"height")
Label13.W=6

Label14=Frame1:addLabel(30.0,9.0,"◄───────────────────────►")
Label14.W=25

Label15=Frame1:addLabel(35.0,7.0,"width")
Label15.W=5

widthEdit=Frame1:addEdit(41.0,6.0, function(e)
    local ok, r = pcall(tonumber,e.text)
    if ok then
        size=clamp(r,0,32)
    end
    e.text=tostring(size)
    e:redraw()
end)
widthEdit.fontColor=7838207
widthEdit.W=9
widthEdit.text=tostring(size)

yOffsetEdit=Frame1:addEdit(38.0,12.0, function(e)
    local ok, r = pcall(tonumber,e.text)
    if ok then
        elevation=clamp(r,-32,31)
        height=clamp(height,1,32-elevation)
    end
    e.text=tostring(elevation)
    e:redraw()
    heightEdit.text=tostring(height)
    heightEdit:redraw()
end)
yOffsetEdit.fontColor=7838207
yOffsetEdit.W=9
yOffsetEdit.text=tostring(elevation)

Label7=Frame1:addLabel(29.0,13.0,"Y offset")
Label7.W=8

heightEdit=Frame1:addEdit(12.0,8.0, function(e)
    local ok, r = pcall(tonumber,e.text)
    if ok then
        height=clamp(r,1,32-elevation)
    end
    e.text=tostring(height)
    e:redraw()
end)
heightEdit.fontColor=7838207
heightEdit.W=9
heightEdit.text=tostring(height)

Button1=Form1:addButton(78.0,1,"x",function()
    saveConfig()
    forms.stop()
    gpu.setForeground(fontColor)
    gpu.setBackground(backColor)
    require("term").clear()
    os.execute("cls")
end)
Button1.W=3
Button1.color=16742297

hardnessEdit=Form1:addEdit(73.0,13.0, function(e)
    local ok, r = pcall(tonumber,e.text)
    if ok then
        hardness=r
    end
    e.text=tostring(hardness)
    e:redraw()
end)
hardnessEdit.fontColor=7838207
hardnessEdit.W=5
hardnessEdit.text=tostring(hardness)

LLL=Form1:addLabel(61.0,14.0,"")
LLL.color=13421772
LLL.fontColor=16711680
LLL.centered=true
LLL.W=2

forms.run(Form1)
